import{r as i,j as a,d as S,e as E}from"./index-react.js";import{u as b,P as M,T as P,C as O}from"./index-react-three.js";import{M as l}from"./index-threejs.js";import"./index2.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const f=()=>!window.invokeNative,X=()=>{},Y=(e,t)=>e>0&&e<90?t:e>-180&&e<-90||e>0?-t:t,p=(e,t)=>{const n=i.useRef(X);i.useEffect(()=>{n.current=t},[t]),i.useEffect(()=>{const c=o=>{const{action:s,data:d}=o.data;n.current&&s===e&&n.current(d)};return window.addEventListener("message",c),()=>window.removeEventListener("message",c)},[e])};async function Z(e,t,n){if(f())return await new Promise(s=>s);const c={method:"post",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(t)};return await(await fetch(`https://${GetParentResourceName()}/gizmo:${e}`,c)).json()}const A=()=>{const{camera:e}=b();return p("SetCameraPosition",({position:t,rotation:n})=>{e.position.set(t.x,t.z,-t.y),e.rotation.order="YZX",n&&e.rotation.set(l.degToRad(n.x),l.degToRad(Y(n.x,n.z)),l.degToRad(n.y)),e.updateProjectionMatrix()}),a.jsx(M,{position:[0,0,10],makeDefault:!0,onUpdate:t=>t.updateProjectionMatrix()})},C=()=>{const e=i.useRef(null),[t,n]=i.useState(),[c,o]=i.useState("translate"),[s,d]=i.useState(!0),[m,g]=i.useState(!0),[w,h]=i.useState(!0),[x,R]=i.useState(!0),[T,j]=i.useState(!0),[y,z]=i.useState(!0),v=async()=>{const r={handle:t,position:{x:e.current.position.x,y:-e.current.position.z,z:e.current.position.y},rotation:{x:l.radToDeg(e.current.rotation.x),y:l.radToDeg(-e.current.rotation.z),z:l.radToDeg(e.current.rotation.y)}},u=await Z("UpdateEntity",r);(u==null?void 0:u.status)!=="ok"&&(e.current.position.set(u.position.x,u.position.z,-u.position.y),e.current.rotation.order="YZX",e.current.rotation.set(l.degToRad(u.rotation.x),l.degToRad(u.rotation.z),l.degToRad(u.rotation.y)))};return p("SetupGizmo",r=>{n(r.handle),r.handle&&(e.current.position.set(r.position.x,r.position.z,-r.position.y),e.current.rotation.order="YZX",e.current.rotation.set(l.degToRad(r.rotation.x),l.degToRad(r.rotation.z),l.degToRad(r.rotation.y)),r.gizmoMode&&o(r.gizmoMode),d(r.allowTranslateX??!0),g(r.allowTranslateY??!0),h(r.allowTranslateZ??!0),R(r.allowRotateX??!0),j(r.allowRotateY??!0),z(r.allowRotateZ??!0))}),p("SetGizmoMode",r=>{o(r)}),a.jsx(a.Fragment,{children:a.jsxs(i.Suspense,{fallback:a.jsx("p",{children:"Loading..."}),children:[t!=null&&a.jsx(P,{size:.5,object:e,mode:c,onObjectChange:v,showX:c==="translate"?s:x,showY:c==="translate"?w:y,showZ:c==="translate"?m:T}),a.jsx("mesh",{ref:e})]})})},L=()=>a.jsxs(O,{style:{zIndex:1},children:[a.jsx(A,{}),a.jsx(C,{})]});function N(){return a.jsx("div",{style:{width:"100vw",height:"100vh"},children:a.jsx(L,{})})}S.createRoot(document.getElementById("root")).render(a.jsx(E.StrictMode,{children:a.jsx(N,{})}));if(f()){const e=document.getElementById("root");e.style.backgroundImage='url("https://i.imgur.com/3pzRj9n.png")',e.style.backgroundSize="cover",e.style.backgroundRepeat="no-repeat",e.style.backgroundPosition="center"}
